<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unihtee">
<title>Using unihtee • unihtee</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using unihtee">
<meta property="og:description" content="unihtee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">unihtee</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/using-unihtee.html">Using unihtee</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using unihtee</h1>
                        <h4 data-toc-skip class="author"><a href="https://pboileau.ca" class="external-link">Philippe Boileau</a></h4>
            
            <h4 data-toc-skip class="date">2023-04-14</h4>
      
      
      <div class="d-none name"><code>using-unihtee.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Rsolnp</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost" class="external-link">xgboost</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/imbs-hl/ranger" class="external-link">ranger</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.users.sonic.net/earth/" class="external-link">earth</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">unihtee</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Treatment effect modifiers (TEMs) are responsible for the disparate
effects of a treatment on a population. They are confounders — meaning
they influence both the likelihood of receiving treatment and the
outcome — that modify the effect of treatment on the outcome. In
precision medicine, these effect modifiers delineate patient subgroups
which experience differing benefit from a given medical intervention. In
public health, they are used to determine the effect of policy decisions
on sub-populations. Identifying TEMs, if any exist, is required for a
comprehensive understanding of an intervention’s effect on a
population.</p>
<p>Traditional parametric modeling techniques, like generalized linear
models (GLMs), define TEMs as the confounders with non-zero
confounder-treatment interaction terms. In settings characterized by
time-to-event outcomes, the Cox proportional hazards model can similarly
be used. Inference about TEMs is therefore possible under stringent
conditions about the data-generating process. When these
(semi)parametric methods’ assumptions, like linearity of the
confounder-outcome relationship in a linear model or proportional
hazards in a Cox model, are violated, however, their results are
invalid.</p>
<p>More flexible approaches instead focus on estimating the conditional
average treatment effect (CATE) using interpretable modeling techniques,
like the LASSO <span class="citation">(Tibshirani 1996; Tian et al.
2014; S. Chen et al. 2017; Q. Zhao, Small, and Ertefaie 2018; Semenova
and Chernozhukov 2020; Bahamyirou et al. 2022)</span> or Random Forests
<span class="citation">(Breiman 2001; Wager and Athey 2018; Cui et al.
2022)</span>. Again, however, these methods require restrictive
assumptions about the data-generating process, like sparsity of
treatment effect modification <span class="citation">(P. Zhao and Yu
2006)</span>, approximately uncorrelated confounders <span class="citation">(P. Zhao and Yu 2006; Hastie, Tibshirani, and Friedman
2009)</span> and sample sizes that are much larger than the number of
confounders <span class="citation">(P. Zhao and Yu 2006)</span>, to
reliably recover TEMs.</p>
<p>Instead of identifying TEMs indirectly by modeling the
confounder-treatment-outcome relationship, recent work has developed
frameworks tailored to the task <span class="citation">(Williamson et
al. 2022; Boileau et al. 2022, 2023; Hines, Diaz-Ordaz, and Vansteelandt
2022)</span>. Relying on TEM variable importance parameters (TEM-VIP),
it is possible to assess confounders’ influence on the treatment effect
in nonparametric, algorithm-agnostic fashion that largely avoids the
pitfalls of parametric and CATE-based methodologies. These TEM-VIPs are
defined within nonparametric statistical models that may be augmented
with causal interpretations, permitting formal inference about TEMs.</p>
<p>The <code>unihtee</code> R package implements the recent proposals of
<span class="citation">Boileau et al. (2022)</span> and <span class="citation">Boileau et al. (2023)</span>. This TEM-VIP framework
relies on parameters assess the marginal effect of each confounder on
treatment effect heterogeneity, however treatment effect is defined.
Nonparametric estimators are provided in these works, and their
asymptotic properties established. In particular, these estimators are
shown to be asymptotically linear under minimal assumptions about the
data-generating process, and to recover treatment effect modifiers more
readily than competing methods. These TEM-VIPs and estimators are
introduced alongside worked examples in the following section.</p>
</div>
<div class="section level2">
<h2 id="unihtee-in-action">
<code>unihtee</code> in Action<a class="anchor" aria-label="anchor" href="#unihtee-in-action"></a>
</h2>
<p>The <code>unihtee</code> R package performs inference about TEM-VIPs
in data-generating processes with a binary exposure variable and either
continuous, binary, or right-censored time-to-event outcomes. No
restriction is placed on the confounding variables, though ordinal
confounders should be formatted as factors using <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered()</a></code>,
and categorical confounders should be one-hot encoded.</p>
<div class="section level3">
<h3 id="working-with-continuous-outcomes">Working with Continuous Outcomes<a class="anchor" aria-label="anchor" href="#working-with-continuous-outcomes"></a>
</h3>
<p>Let there be <span class="math inline">\(n\)</span> independent and
identically distributed (i.i.d.) random vectors <span class="math inline">\({X_i}_{i=1}^n\)</span> such that <span class="math inline">\(X_i = (W_i, A_i, Y^{(0)}, Y_i^{(1)}) \sim P_{X,0}
\in \mathcal{M}_X\)</span>. Dropping the index where possible for
notational convenience for the remainder of the tutorial, <span class="math inline">\(W\)</span> is defined as the set of <span class="math inline">\(p\)</span> confounders, <span class="math inline">\(A\)</span> as the binary treatment indicator, and
<span class="math inline">\(Y^{(0)}, Y_i^{(1)}\)</span> the continuous
potential outcomes <span class="citation">(Rubin 1974)</span> produced
under control and treatment conditions, respectively. Further, <span class="math inline">\(\mathcal{M}_X\)</span> is the full-data
nonparametric model of all possible data-generating processes, and
contains the true but unknown full-data data-generating process <span class="math inline">\(P_{X,0}\)</span>.</p>
<p>Now, <span class="math inline">\(P_{X,0}\)</span> is generally
unknown because its random vectors are unobservable: only one potential
outcome is ever measurable in practice. Still, <span class="math inline">\(P_{X,0}\)</span> allows to us to readily define
causal parameters on which inference may subsequently be performed.
Examples are given in the subsections below.</p>
<p>We instead have access to <span class="math inline">\(n\)</span>
i.i.d. random observations <span class="math inline">\(O=(W,A,Y) \sim
P_0 \in \mathcal{M}\)</span>, where <span class="math inline">\(W\)</span> and <span class="math inline">\(A\)</span> are defined as in the full-data, and
where <span class="math inline">\(Y = AY^{(1)} + (1-A)Y{(0)}\)</span>.
<span class="math inline">\(\mathcal{M}\)</span> is the observed-data
statistical model containing all possible observed-data data-generating
processes, including the true data-generating process <span class="math inline">\(P_{0}\)</span>. Note too that the elements of
<span class="math inline">\(\mathcal{M}\)</span> are fully specified by
their full-data counterparts in <span class="math inline">\(\mathcal{M}_{X}\)</span>.</p>
<p>Having established the requisite statistical objects, let’s define a
data-generating process:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cont_outcome_dgp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># confounders</span></span>
<span>  <span class="va">w_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># treatment</span></span>
<span>  <span class="va">prop_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">prop_score</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># potential outcomes</span></span>
<span>  <span class="va">y_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mean <span class="op">=</span> <span class="va">w_1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">w_2</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">w_3</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">a</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>  <span class="va">y_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mean <span class="op">=</span> <span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># outcome</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">y_1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">*</span> <span class="va">y_0</span></span>
<span></span>
<span>  <span class="co"># assemble the observations in a tibble</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    w_1 <span class="op">=</span> <span class="va">w_1</span>,</span>
<span>    w_2 <span class="op">=</span> <span class="va">w_2</span>,</span>
<span>    w_3 <span class="op">=</span> <span class="va">w_3</span>,</span>
<span>    w_4 <span class="op">=</span> <span class="va">w_4</span>,</span>
<span>    w_5 <span class="op">=</span> <span class="va">w_5</span>,</span>
<span>    a <span class="op">=</span> <span class="va">a</span>,</span>
<span>    y <span class="op">=</span> <span class="va">y</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>It’s clear from the definition of the potential outcomes that
<code>w_2</code> and <code>w_3</code> are treatment effect modifiers:
they interact with the treatment indicator <code>a</code>. A TEM-VIP for
quantifying the strength of the treatment effect modification is
outlined next.</p>
<div class="section level4">
<h4 id="absolute-tem-vip">Absolute TEM-VIP<a class="anchor" aria-label="anchor" href="#absolute-tem-vip"></a>
</h4>
<p>Indexing <span class="math inline">\(W\)</span> by <span class="math inline">\(j=1,\ldots,p\)</span>, and assuming without loss
of generality that <span class="math inline">\(\mathbb{E}_{P_{X,0}}[W_j]
= 0, \mathbb{E}_{P_{X,0}}[W_j^2] &gt; 0\)</span>, we can define our
first TEM-VIP for the <span class="math inline">\(j^\text{th}\)</span>
confounder as follows:</p>
<p><span class="math display">\[
\Psi^F_j(P_{X,0}) =
\frac{\mathbb{E}_{P_{X,0}}[(Y^{(1)}-Y^{(0)})W_j]}{\mathbb{E}_{P_{X,0}}[W_j^2]}
=\frac{\mathbb{E}_{P_{X,0}}[(\mathbb{E}_{P_{X,0}}[Y^{(1)}|W]-
  \mathbb{E}_{P_{X,0}}[Y^{(0)}|W])W_j]}
  {\mathbb{E}_{P_{X,0}}[W_j^2]} \;.
\]</span></p>
<p>This parameter is called the absolute TEM-VIP. Assuming the
expectation of <span class="math inline">\(\mathbb{E}_{P_{X,0}}[Y^{(1)}|W]-
\mathbb{E}_{P_{X,0}}[Y^{(0)}|W]\)</span> conditional on <span class="math inline">\(W_j\)</span> is linear in <span class="math inline">\(W_j\)</span>, <span class="math inline">\(\Psi^F_j(P_{X,0})\)</span> is the simple linear
regression coefficient produced by regressing the difference in expected
potential outcomes against confounder <span class="math inline">\(W_j\)</span>. Even when this relationship is
nonlinear, as is almost surely the case in most applications, <span class="math inline">\(\Psi^F_j(P_{X,0})\)</span> corresponds to the
correlation between the difference in potential outcomes and the <span class="math inline">\(j^\text{th}\)</span> confounder, re-normalized to
be on the same scale as the potential outcomes.</p>
<p>Of course, as stated earlier, we don’t generally have access to the
full-data random vectors required to perform inference about the above
parameter. Luckily, under the identification conditions outlined in
<span class="citation">Boileau et al. (2022)</span> and <span class="citation">Boileau et al. (2023)</span> — namely, that there is no
unmeasured confounding and no positivity violations — we can perform
inference about the equivalent observed-data parameter:</p>
<p><span class="math display">\[
\Psi_j(P_0)
=\frac{\mathbb{E}_{P_0}[(\mathbb{E}_{P_{0}}[Y|A=1,W]-
  \mathbb{E}_{P_0}[Y|A=0,W])W_j]}{\mathbb{E}_{P_0}[W_j^2]}
= \Psi^F_j(P_{X,0})\;.
\]</span></p>
<p><span class="citation">Boileau et al. (2022)</span> and <span class="citation">Boileau et al. (2023)</span> derive two nonparametric
estimators of this parameter: the one-step and targeted maximum
likelihood (TML) estimators. Both require the estimation of two nuisance
parameters: the propensity score and the expected outcome conditioned on
the treatment and confounders. These estimators are double robust: only
one nuisance parameter is required to be consistently estimated to
ensure that the one-step and TML estimators are consistent. If both
nuisance parameters converge to their true values at a fast enough rate,
then the one-step and TML estimators are asymptotically normal. This
permits hypothesis testing about <span class="math inline">\(\Psi_j(P_0)\)</span> using Wald-type confidence
intervals. Further details on these estimators and their asymptotic
properties are provided in <span class="citation">Boileau et al.
(2022)</span> and <span class="citation">Boileau et al.
(2023)</span>.</p>
<p>Having defined the parameter and briefly discussed the estimators, we
apply <code>unicate()</code> to recover the treatment effect modifiers,
as defined by the absolute TEM-VIP. Both the one-step and TML estimators
are showcased. The LASSO regression of <span class="citation">Tibshirani
(1996)</span> is used to estimate the nuisance parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">514</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate a random sample</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="fu">cont_outcome_dgp</span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># one-step estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"onestep"</span>,</span>
<span>  cond_outcome_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    formula <span class="op">=</span> <span class="st">"~ a * w_1 + a * w_2 + a * w_3 + a * w_4 + a * w_5"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier    estimate         se          z      p_value    ci_lower</span></span>
<span><span class="co">#&gt; 1:      w_3  1.94918442 0.13370581 14.5781579 0.000000e+00  1.68712103</span></span>
<span><span class="co">#&gt; 2:      w_2  0.84690336 0.10529721  8.0429801 8.881784e-16  0.64052083</span></span>
<span><span class="co">#&gt; 3:      w_5  0.14521709 0.10425853  1.3928558 1.636634e-01 -0.05912962</span></span>
<span><span class="co">#&gt; 4:      w_4 -0.13211440 0.10613296 -1.2448009 2.132049e-01 -0.34013499</span></span>
<span><span class="co">#&gt; 5:      w_1 -0.05285389 0.08758479 -0.6034596 5.462030e-01 -0.22452009</span></span>
<span><span class="co">#&gt;      ci_upper  p_value_fdr</span></span>
<span><span class="co">#&gt; 1: 2.21124781 0.000000e+00</span></span>
<span><span class="co">#&gt; 2: 1.05328589 2.220446e-15</span></span>
<span><span class="co">#&gt; 3: 0.34956381 2.665062e-01</span></span>
<span><span class="co">#&gt; 4: 0.07590619 2.665062e-01</span></span>
<span><span class="co">#&gt; 5: 0.11881231 5.462030e-01</span></span>
<span></span>
<span><span class="co"># TML estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span>,</span>
<span>  cond_outcome_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>    formula <span class="op">=</span> <span class="st">"~ a * w_1 + a * w_2 + a * w_3 + a * w_4 + a * w_5"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier    estimate         se          z      p_value    ci_lower</span></span>
<span><span class="co">#&gt; 1:      w_3  1.91206506 0.13386174 14.2838801 0.000000e+00  1.64969605</span></span>
<span><span class="co">#&gt; 2:      w_2  0.81924540 0.10526619  7.7826068 7.105427e-15  0.61292365</span></span>
<span><span class="co">#&gt; 3:      w_5  0.15243525 0.10422216  1.4625992 1.435771e-01 -0.05184018</span></span>
<span><span class="co">#&gt; 4:      w_4 -0.11700272 0.10569020 -1.1070347 2.682789e-01 -0.32415551</span></span>
<span><span class="co">#&gt; 5:      w_1 -0.06328782 0.08714635 -0.7262246 4.677011e-01 -0.23409467</span></span>
<span><span class="co">#&gt;      ci_upper  p_value_fdr</span></span>
<span><span class="co">#&gt; 1: 2.17443407 0.000000e+00</span></span>
<span><span class="co">#&gt; 2: 1.02556714 1.776357e-14</span></span>
<span><span class="co">#&gt; 3: 0.35671067 2.392951e-01</span></span>
<span><span class="co">#&gt; 4: 0.09015007 3.353486e-01</span></span>
<span><span class="co">#&gt; 5: 0.10751902 4.677011e-01</span></span></code></pre></div>
<p><code>unicate()</code> outputs a table of results summarizing the
TEM-VIP inference procedure for each potential treatment effect
modifier. This table ordered by the nominal p-value of the inference
procedure. Both the one-step and TML estimators correctly identify the
TEM-VIP of <code>w_2</code> and <code>w_3</code> as being non-zero based
on the false discovery rate adjusted p-values. Each estimator’s point
estimates are also close to their true parameter values; for every unit
increase in <code>w_2</code>, the one-step and TML estimators suggest
that the average treatment effect increases by <span class="math inline">\(\approx 0.88\)</span> and <span class="math inline">\(\approx 0.86\)</span> units, respectively.
Similarly for <code>w_3</code>, the one-step and TML estimators indicate
that a unit increase in this confounder leads to an increase of <span class="math inline">\(\approx 2.04\)</span> and <span class="math inline">\(\approx 1.98\)</span> in the average treatment
effect, respectively.</p>
</div>
</div>
<div class="section level3">
<h3 id="working-with-binary-outcomes">Working with Binary Outcomes<a class="anchor" aria-label="anchor" href="#working-with-binary-outcomes"></a>
</h3>
<p>In the binary outcome setting, the full-data and observed-data models
and data-generating processes are identical to those of the continuous
outcome setting, save that the outcome is binary. That means the
absolute TEM-VIP can be used as is with binary-outcome data — the only
practical difference is the choice of estimator used for the expected
outcome conditional on the treatment and confounders. With that said, a
relative TEM-VIP is generally more sensitive and informative in these
scenarios. We propose such a parameter in the following section.</p>
<p>Before that, however, we define a data-generating process with two
treatment effect modifiers:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin_outcome_dgp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># confounders</span></span>
<span>  <span class="va">w_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, lambda <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">w_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># treatment</span></span>
<span>  <span class="va">prop_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">w_3</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">prop_score</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># potential outcomes</span></span>
<span>  <span class="va">y_prob_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">w_3</span><span class="op">)</span></span>
<span>  <span class="va">y_prob_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">w_2</span><span class="op">)</span></span>
<span>  <span class="va">y_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">y_prob_1</span><span class="op">)</span></span>
<span>  <span class="va">y_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">y_prob_0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># outcome</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">y_1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span> <span class="op">*</span> <span class="va">y_0</span></span>
<span></span>
<span>  <span class="co"># assemble the observations in a tibble</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    w_1 <span class="op">=</span> <span class="va">w_1</span>,</span>
<span>    w_2 <span class="op">=</span> <span class="va">w_2</span>,</span>
<span>    w_3 <span class="op">=</span> <span class="va">w_3</span>,</span>
<span>    a <span class="op">=</span> <span class="va">a</span>,</span>
<span>    y <span class="op">=</span> <span class="va">y</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here, <code>w_2</code> and <code>w_3</code> are a treatment effect
modifier. They interact with the treatment variable, <code>a</code>.</p>
<div class="section level4">
<h4 id="relative-tem-vip">Relative TEM-VIP<a class="anchor" aria-label="anchor" href="#relative-tem-vip"></a>
</h4>
<p>Again assuming that the confounders are centered at zero with
non-zero variance, the relative TEM-VIP for the <span class="math inline">\(j^\text{th}\)</span> confounder is <span class="math display">\[
\Gamma^F_j(P_{X,0})
=\frac{\mathbb{E}_{P_{X,0}}[(\log\mathbb{E}_{P_{X,0}}[Y^{(1)}|W]-
  \log\mathbb{E}_{P_{X,0}}[Y^{(0)}|W])W_j]}
  {\mathbb{E}_{P_{X,0}}[W_j^2]} \;.
\]</span></p>
<p>Assuming that the expectation of the log ratio of the expected
conditional potential outcomes conditional on <span class="math inline">\(W_j\)</span> is linear in <span class="math inline">\(W_j\)</span>, <span class="math inline">\(\Gamma^F_j(P_{X,0})\)</span> is the simple linear
regression coefficient obtained by regressing the log ratio of the
expected conditional potential outcomes on <span class="math inline">\(W_j\)</span>. As with <span class="math inline">\(\Psi^F_j(P_{X,0})\)</span>, this parameter can be
interpreted as standardized correlation coefficient of the log ratio of
expected potential outcomes and the <span class="math inline">\(j^\text{th}\)</span> confounder.</p>
<p>We highlight that this TEM-VIP isn’t restricted to data-generating
processes with binary outcomes; it may also be used when the outcome is
non-negative, continuous or discrete random variable.</p>
<p>Again, much like <span class="math inline">\(\Psi^F_j(P_{X,0})\)</span>, <span class="math inline">\(\Gamma^F_j(P_{X,0})\)</span> isn’t generally ever
observed since it is a parameter of the full-data model. Under the
conditions of no unmeasured confounding and in the absence of positivity
violations, however, an equivalent parameter can be estimated from the
observed-data:</p>
<p><span class="math display">\[
\Gamma_j(P_0)
=\frac{\mathbb{E}_{P_0}[(\log\mathbb{E}_{P_{0}}[Y|A=1,W]-
  \log\mathbb{E}_{P_0}[Y|A=0,W])W_j]}{\mathbb{E}_{P_0}[W_j^2]}
= \Gamma^F_j(P_{X,0})\;.
\]</span></p>
<p>Nonparametric one-step and TML estimators of this parameter are
derived by <span class="citation">Boileau et al. (2023)</span> and
implemented in the <code>unicate</code> package. Just like <span class="math inline">\(\Psi_j(P_0)\)</span>, inference about this
parameter depends on the estimation of the propensity score and the
expected outcome conditional on treatment indicator and confounders.
These estimators are consistent if both nuisance parameters are
consistently estimated, and are asymptotically normal if both converge
to their true values at rate of <span class="math inline">\(n^{-1/4}\)</span>. The latter permits hypothesis
testing based on the Gaussian. Additional details are provided by <span class="citation">Boileau et al. (2023)</span>.</p>
<p>We now apply these estimators to a random sample generated by
<code>bin_outcome_dgp()</code>. The nuisance parameters are estimated
using Random Forests implemented in <code>ranger</code> package <span class="citation">(Breiman 2001; Wright and Ziegler 2017)</span>. Note
too that these estimators are fit using cross-fitting <span class="citation">(Zheng and van der Laan 2011; Chernozhukov et al.
2017)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate a random sample</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="fu">bin_outcome_dgp</span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># one-step estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"onestep"</span>,</span>
<span>  cond_outcome_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_ranger.html" class="external-link">Lrnr_ranger</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_ranger.html" class="external-link">Lrnr_ranger</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cross_fit <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier   estimate        se         z      p_value   ci_lower   ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_2 -1.1714214 0.2831918 -4.136495 3.526517e-05 -1.7264774 -0.6163655</span></span>
<span><span class="co">#&gt; 2:      w_3 -2.7446161 1.0922870 -2.512724 1.198029e-02 -4.8854986 -0.6037336</span></span>
<span><span class="co">#&gt; 3:      w_1  0.2347776 0.1871624  1.254406 2.096946e-01 -0.1320607  0.6016159</span></span>
<span><span class="co">#&gt;     p_value_fdr</span></span>
<span><span class="co">#&gt; 1: 0.0001057955</span></span>
<span><span class="co">#&gt; 2: 0.0179704377</span></span>
<span><span class="co">#&gt; 3: 0.2096945985</span></span>
<span></span>
<span><span class="co"># TML estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span>,</span>
<span>  cond_outcome_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_ranger.html" class="external-link">Lrnr_ranger</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_ranger.html" class="external-link">Lrnr_ranger</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cross_fit <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier     estimate        se           z      p_value   ci_lower</span></span>
<span><span class="co">#&gt; 1:      w_3 -3.478340586 0.7746871 -4.48999399 7.122518e-06 -4.9967274</span></span>
<span><span class="co">#&gt; 2:      w_2 -1.425906898 0.3203599 -4.45095295 8.549007e-06 -2.0538123</span></span>
<span><span class="co">#&gt; 3:      w_1  0.009961001 0.1692693  0.05884707 9.530739e-01 -0.3218068</span></span>
<span><span class="co">#&gt;      ci_upper  p_value_fdr</span></span>
<span><span class="co">#&gt; 1: -1.9599538 1.282351e-05</span></span>
<span><span class="co">#&gt; 2: -0.7980015 1.282351e-05</span></span>
<span><span class="co">#&gt; 3:  0.3417288 9.530739e-01</span></span></code></pre></div>
<p>Both estimators correctly identify <code>w_2</code> and
<code>w_3</code> as treatment effect modifiers, as defined by the
relative TEM-VIP. The one-step estimator’s results suggest that for
every unit increase in <code>w_2</code> and <code>w_3</code>, the log
ratio of the conditional expected potential outcomes is expected to
decrease by <span class="math inline">\(\approx 1.06\)</span> and <span class="math inline">\(\approx 3.00\)</span> units, respectively. For the
TML estimator, the log ration of the conditional expected outcomes is
expected to decrease by <span class="math inline">\(\approx
1.39\)</span> and <span class="math inline">\(\approx 3.52\)</span> for
every unit increase in <code>w_2</code> and <code>w_3</code>,
respectively.</p>
</div>
</div>
<div class="section level3">
<h3 id="working-with-time-to-event-outcomes">Working with Time-to-Event Outcomes<a class="anchor" aria-label="anchor" href="#working-with-time-to-event-outcomes"></a>
</h3>
<p><code>unihtee</code> also provides functionality for estimating
TEM-VIPs for data with right-censored time-to-event outcomes. We detail
the assumed full-data and observed-data models here, then introduce an
absolute and a relative TEM-VIP in subsequent sections.</p>
<p>Consider <span class="math inline">\(n\)</span> i.i.d. random vectors
<span class="math inline">\(X = (W, A, C^{(0)}, C^{(1)}, T^{(0)},
T^{(1)}) \sim P_{X,0} \in \mathcal{M}_X\)</span>. <span class="math inline">\(W, A, P_{X,0},\)</span> and <span class="math inline">\(\mathcal{M}_X\)</span> are defined as in the
continuous and binary outcome models. <span class="math inline">\(C^{(0)}\)</span> and <span class="math inline">\(C^{(1)}\)</span> correspond to the censoring times
that would be observed under the control and treatment conditions,
respectively. Similarly, <span class="math inline">\(T^{(0)}\)</span>
and <span class="math inline">\(T^{(1)}\)</span> are the event times
that would be observed under either treatment assignment.</p>
<p>Again, <span class="math inline">\(P_{X,0}\)</span> is generally
unobservable. We instead have access to random observations <span class="math inline">\(O = (W, A, \Delta, T) \sim P_0 \in
\mathcal{M}\)</span>, where <span class="math inline">\(\Delta\)</span>
is a censoring indicator and <span class="math inline">\(T = A(\Delta
C^{(1)} + (1-\Delta)T^{(1)}) + (1-A)(\Delta C^{(0)} + (1-\Delta)
T^{(0)})\)</span>. <span class="math inline">\(W, A, P_0,\)</span> and
<span class="math inline">\(\mathcal{M}\)</span> are defined as in the
previous observed-data models.</p>
<p>Now, it’s worth introducing the full-data and observed-data
conditional survival functions since both TEM-VIPs introduced in this
section rely on them. The full-data survival function is defined as
<span class="math inline">\(S_{P_{X,0}}(t|A,W) =
\mathbb{P}_{P_{X,0}}[T^{(A)} &gt; t | W]\)</span>. This parameter’s
observed-data counterpart is defined analogously as <span class="math inline">\(S_0(t|A,W) = P_{P_0}[T &gt; t |A, W]\)</span>.</p>
<p>Finally, we define a time-to-event data-generating process with nine
equidistant time points and three potential confounders,
<code>w_1</code>, <code>w_2</code>, and <code>w_3</code>. Of these
confounders, only <code>w_1</code> is a treatment effect modifier. Note
that <code><a href="../reference/unihtee.html">unihtee()</a></code> requires a “wide” data format when working
time-to-event outcome data. That is, each observation is represented by
a single row in the data. An example is provided following this code
chunk.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define hazard functions</span></span>
<span><span class="va">cond_cens_hazard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span>, <span class="va">a</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">time</span> <span class="op">&lt;</span> <span class="fl">9</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="op">(</span><span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">cond_surv_hazard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span>, <span class="va">a</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">time</span> <span class="op">&lt;</span> <span class="fl">9</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># failure time simulator</span></span>
<span><span class="va">failure_time_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_obs</span>, <span class="va">a</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">failure_time</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu">cond_surv_hazard</span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">w_1</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span>, <span class="va">w_2</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span>, <span class="va">w_3</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">failure_time</span> <span class="op">&lt;-</span> <span class="va">t</span></span>
<span>          <span class="kw">break</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">failure_time</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># censoring time simulator</span></span>
<span><span class="va">censor_time_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_obs</span>, <span class="va">a</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu">cond_cens_hazard</span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">w_1</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span>, <span class="va">w_2</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span>, <span class="va">w_3</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="va">t</span></span>
<span>          <span class="kw">break</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">censor_time</span><span class="op">)</span><span class="op">)</span> <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">censor_time</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># time-to-event outcome data-generating process</span></span>
<span><span class="va">tte_outcome_dgp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># confounders</span></span>
<span>  <span class="va">w_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span>  <span class="va">w_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># treatment</span></span>
<span>  <span class="va">prop_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">-</span> <span class="va">w_1</span> <span class="op">+</span> <span class="va">w_2</span> <span class="op">-</span> <span class="va">w_3</span><span class="op">)</span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">prop_score</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># generate the failure events for t = 1 to 9</span></span>
<span>  <span class="va">failure_time_1</span> <span class="op">&lt;-</span> <span class="fu">failure_time_sim</span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span></span>
<span>  <span class="va">failure_time_0</span> <span class="op">&lt;-</span> <span class="fu">failure_time_sim</span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">0</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># generate the censoring events for t = 1 to 9</span></span>
<span>  <span class="va">censor_time_1</span> <span class="op">&lt;-</span> <span class="fu">censor_time_sim</span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span></span>
<span>  <span class="va">censor_time_0</span> <span class="op">&lt;-</span> <span class="fu">censor_time_sim</span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">0</span>, <span class="va">w_1</span>, <span class="va">w_2</span>, <span class="va">w_3</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># compile the failure and censoring times</span></span>
<span>  <span class="va">failure_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">failure_time_1</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span> <span class="kw">else</span> <span class="va">failure_time_0</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">censor_time_1</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span> <span class="kw">else</span> <span class="va">censor_time_0</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># determine the observed time-to-event and censoring indicator</span></span>
<span>  <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">censor_time</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">failure_time</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">censor_time</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">failure_time</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">censoring_indicator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="va">time</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span> <span class="op">==</span> <span class="va">censor_time</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span><span class="op">)</span> <span class="fl">1</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># assemble the tibble</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    w_1 <span class="op">=</span> <span class="va">w_1</span>,</span>
<span>    w_2 <span class="op">=</span> <span class="va">w_2</span>,</span>
<span>    w_3 <span class="op">=</span> <span class="va">w_3</span>,</span>
<span>    a <span class="op">=</span> <span class="va">a</span>,</span>
<span>    time <span class="op">=</span> <span class="va">time</span>,</span>
<span>    censoring_indicator <span class="op">=</span> <span class="va">censoring_indicator</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tte_outcome_dgp</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt;       w_1     w_2    w_3     a  time censoring_indicator</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  0.185  0.369   0.753     0     9                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">1.19</span>   1.13   -<span style="color: #BB0000;">1.96</span>      1     1                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.926</span>  0.551  -<span style="color: #BB0000;">1.23</span>      1     1                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  1.59  -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">5</span>  0.725     0     4                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">1.59</span>   1.13   -<span style="color: #BB0000;">1.88</span>      1     1                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">1.07</span>   1.31    0.492     0     7                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.861</span> -<span style="color: #BB0000;">1.73</span>    0.430     0     6                   1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">1.57</span>   1.30    1.08      1     1                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.600</span>  0.036<span style="text-decoration: underline;">7</span> -<span style="color: #BB0000;">1.40</span>      0     1                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.410</span>  1.30   -<span style="color: #BB0000;">0.238</span>     0     6                   0</span></span></code></pre></div>
<div class="section level4">
<h4 id="absolute-tem-vip-1">Absolute TEM-VIP<a class="anchor" aria-label="anchor" href="#absolute-tem-vip-1"></a>
</h4>
<p><span class="citation">Boileau et al. (2023)</span> Propose an
absolute TEM-VIP based on the restricted mean survival time at some
pre-specified time <span class="math inline">\(t\)</span>. Again
assuming without loss of generality that the <span class="math inline">\(\mathbb{E}_{P_{X,0}}[W_j] = 0\)</span> and that
the confounders have variance bounded away from zero, this TEM-VIP is
defined as <span class="math display">\[
\Psi_j^F(P_{X,0};t) = \frac{\mathbb{E}_{P_{X,0}}\left[W_j
  \int_0^t \{ S_{P_{X,0}}(u|1, W) - S_{P_{X,0}}(u|0, W) \} du \right]}
  {\mathbb{E}_{P_{X,0}}[W_j^2]} \; .
\]</span></p>
<p>“<span class="math inline">\(\Psi\)</span>” is re-used to highlight
that this is an absolute TEM-VIP. As in the continuous outcome scenario,
this parameter captures the correlation between the conditional
difference in the restricted mean survival time and the <span class="math inline">\(j^\text{th}\)</span> confounder, re-normalized to
be on the same scale as the outcome. Put another way, this parameter
identifies confounders driving the largest difference in truncated
survival times across treatment conditions.</p>
<p>As before, this full-data parameter is equal to the following
observed-data parameter under the assumptions of (1) no unmeasured
confounding, (2) censoring mechanism positivity, and (3) treatment
assignment positivity: <span class="math display">\[
\Psi_j(P_0;t) = \frac{\mathbb{E}_{P_0}\left[W_j
  \int_0^t \{ S_0(u|1, W) - S_0(u|0, W) \} du \right]}
  {\mathbb{E}_{P_0}[W_j^2]} \; .
\]</span></p>
<p>As in the continuous and binary outcome scenarios, <span class="citation">Boileau et al. (2023)</span> derived two estimators of
this absolute effect parameter: a one-step estimator and a TML
estimator. Both rely on the accurate estimation of three nuisance
parameters: the conditional event hazard function, the conditional
censoring hazard function, and the propensity score. If either the
conditional event hazard function or the conditional censoring hazard
function and the propensity score are consistently estimated, then these
nonparametric estimators are consistent. Further, if all of these
nuisance parameters are converge to their true values at a rate of <span class="math inline">\(n^{-1/4}\)</span>, then these estimators are
asymptotically normally distributed. This permits Gaussian-based
hypothesis testing through the use of Wald-type confidence intervals.
See <span class="citation">Boileau et al. (2023)</span> for more
details.</p>
<p>We now apply these estimators to a random sample from the
data-generating process defined above, choosing as target parameter
<span class="math inline">\(\Psi(P_0; 8)\)</span>. LASSO regressions are
used to estimate the propensity scores and censoring hazard functions,
and, as demonstration of these methods’ flexibility, estimate the
failure hazard function with XGBoost <span class="citation">(T. Chen and
Guestrin 2016)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate a random sample</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="fu">tte_outcome_dgp</span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># one-step estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  censoring <span class="op">=</span> <span class="st">"censoring_indicator"</span>,</span>
<span>  time_cutoff <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"time-to-event"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"onestep"</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  failure_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_xgboost.html" class="external-link">Lrnr_xgboost</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  censoring_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier    estimate        se          z      p_value   ci_lower  ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_1  1.65578106 0.3100170  5.3409367 9.246754e-08  1.0481478 2.2634143</span></span>
<span><span class="co">#&gt; 2:      w_2 -0.27580480 0.2378789 -1.1594338 2.462794e-01 -0.7420474 0.1904378</span></span>
<span><span class="co">#&gt; 3:      w_3  0.04483202 0.2631764  0.1703497 8.647351e-01 -0.4709937 0.5606577</span></span>
<span><span class="co">#&gt;     p_value_fdr</span></span>
<span><span class="co">#&gt; 1: 2.774026e-07</span></span>
<span><span class="co">#&gt; 2: 3.694191e-01</span></span>
<span><span class="co">#&gt; 3: 8.647351e-01</span></span>
<span></span>
<span><span class="co"># TML estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  censoring <span class="op">=</span> <span class="st">"censoring_indicator"</span>,</span>
<span>  time_cutoff <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"time-to-event"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  failure_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_xgboost.html" class="external-link">Lrnr_xgboost</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  censoring_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier    estimate        se          z      p_value   ci_lower   ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_1  1.24516252 0.3137506  3.9686383 7.228451e-05  0.6302114 1.86011363</span></span>
<span><span class="co">#&gt; 2:      w_2 -0.37336556 0.2401380 -1.5547961 1.199946e-01 -0.8440360 0.09730484</span></span>
<span><span class="co">#&gt; 3:      w_3 -0.07052526 0.2658042 -0.2653278 7.907569e-01 -0.5915015 0.45045101</span></span>
<span><span class="co">#&gt;     p_value_fdr</span></span>
<span><span class="co">#&gt; 1: 0.0002168535</span></span>
<span><span class="co">#&gt; 2: 0.1799919603</span></span>
<span><span class="co">#&gt; 3: 0.7907569131</span></span></code></pre></div>
<p>These results suggest every unit increase in <code>w_1</code> results
in an increase of <span class="math inline">\(\approx 1.66\)</span> —
according to the one-step estimator — or <span class="math inline">\(\approx 1.25\)</span> — according to the TML
estimator — time units for the difference in mean survival times,
truncated at time eight.</p>
</div>
<div class="section level4">
<h4 id="relative-tem-vip-1">Relative TEM-VIP<a class="anchor" aria-label="anchor" href="#relative-tem-vip-1"></a>
</h4>
<p>We next consider a relative TEM-VIP for data with right-censored
time-to-event outcomes. Again assuming that the potential treatment
effect modifiers are centered and have variance bounded away from zero,
we define this parameter as follows for the <span class="math inline">\(j^\text{th}\)</span> confounder: <span class="math display">\[
\Gamma_j^F(P_{X,0};t) = \frac{\mathbb{E}_{P_{X,0}}\left[W_j
  (\log S_{P_{X,0}}(t|1, W) - \log S_{P_{X,0}}(t|0, W))\right]}
  {\mathbb{E}_{P_{X,0}}[W_j^2]} \; .
\]</span></p>
<p>For some pre-specified time point <span class="math inline">\(t\)</span>, this TEM-VIP represents the
standardized correlation coefficient of <span class="math inline">\(W_j\)</span> and the log ratio of conditional
survival times under each treatment condition. As with “<span class="math inline">\(\Psi\)</span>”, we re-use “<span class="math inline">\(\Gamma\)</span>” to highlight that this is a
relative effect parameter. Its observed-data counterpart is given by
<span class="math display">\[
\Gamma_j^F(P_0;t) = \frac{\mathbb{E}_{P_0}\left[W_j
  (\log S_0(t|1, W) - \log S_0(t|0, W))\right]}
  {\mathbb{E}_{P_0}[W_j^2]} \; ,
\]</span> again assuming that there is no unmeasured confounding and
that there are no positivity violations of the censoring or treatment
assignment mechanisms.</p>
<p><span class="citation">Boileau et al. (2023)</span> derived one-step
and TML estimators of this parameter, again requiring the estimation of
three nuisance parameters: the propensity score and the conditional
failure and censoring event hazards. These one-step and TML estimators
are consistent when all nuisance parameters are estimated consistently,
and are asymptotically linear when these nuisance parameters converge to
their true values at a fast-enough rate <span class="citation">(Boileau
et al. 2023)</span>.</p>
<p>We apply the nonparametric estimators of <span class="citation">Boileau et al. (2023)</span> to a random sample
generated by <code>tte_outcome_dgp()</code>, taking as target of
inference <span class="math inline">\(\Gamma_j(P_0; 5)\)</span>. The
nuisance parameters are estimated using the same strategy employed in
prior absolute TEM-VIP example.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate a random sample</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="fu">tte_outcome_dgp</span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># one-step estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  censoring <span class="op">=</span> <span class="st">"censoring_indicator"</span>,</span>
<span>  time_cutoff <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"time-to-event"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"onestep"</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  failure_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_xgboost.html" class="external-link">Lrnr_xgboost</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  censoring_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cross_fit <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier   estimate        se          z      p_value  ci_lower  ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_1  3.2868215 0.7571221  4.3412042 1.417039e-05  1.802862 4.7707807</span></span>
<span><span class="co">#&gt; 2:      w_3 -1.6368035 1.2089918 -1.3538582 1.757816e-01 -4.006428 0.7328204</span></span>
<span><span class="co">#&gt; 3:      w_2 -0.5309253 0.7692443 -0.6901908 4.900742e-01 -2.038644 0.9767935</span></span>
<span><span class="co">#&gt;     p_value_fdr</span></span>
<span><span class="co">#&gt; 1: 4.251118e-05</span></span>
<span><span class="co">#&gt; 2: 2.636724e-01</span></span>
<span><span class="co">#&gt; 3: 4.900742e-01</span></span>
<span></span>
<span><span class="co"># TML estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  censoring <span class="op">=</span> <span class="st">"censoring_indicator"</span>,</span>
<span>  time_cutoff <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"time-to-event"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  failure_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_xgboost.html" class="external-link">Lrnr_xgboost</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  censoring_hazard_estimator <span class="op">=</span> <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cross_fit <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier   estimate       se           z     p_value   ci_lower  ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_1  3.2826140 1.139237  2.88141401 0.003958952   1.049709  5.515519</span></span>
<span><span class="co">#&gt; 2:      w_2  0.2824440 1.057572  0.26706826 0.789416602  -1.790398  2.355286</span></span>
<span><span class="co">#&gt; 3:      w_3 -0.2385342 6.600093 -0.03614104 0.971169901 -13.174716 12.697648</span></span>
<span><span class="co">#&gt;    p_value_fdr</span></span>
<span><span class="co">#&gt; 1:  0.01187686</span></span>
<span><span class="co">#&gt; 2:  0.97116990</span></span>
<span><span class="co">#&gt; 3:  0.97116990</span></span></code></pre></div>
<p>Again, both the one-step and TML estimators successfully discern the
treatment effect modifier from the other potential confounders when
using a false discovery rate cutoff of <span class="math inline">\(5\%\)</span>. These results indicate that a unit
increase in <code>w_1</code> results in an increase of the log ratio of
conditional survivals equal to either <span class="math inline">\(\approx 3.29\)</span> or <span class="math inline">\(\approx 3.28\)</span>, depending on whether one
uses the one-step estimator or the TML estimator.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-features-and-notes">Additional Features and Notes<a class="anchor" aria-label="anchor" href="#additional-features-and-notes"></a>
</h2>
<div class="section level3">
<h3 id="working-with-randomized-experiment-data">Working with Randomized Experiment Data<a class="anchor" aria-label="anchor" href="#working-with-randomized-experiment-data"></a>
</h3>
<p>While <code>unihtee</code>’s estimators are applied to (simulated)
observational data in the previous section’s examples, they are also
suitable for data generated by randomized experiments. The propensity
scores used to randomize observations should be saved data object passed
to <code><a href="../reference/unihtee.html">unihtee()</a></code>, and the name of the variable containing these
scores should be indicated in the <code>propensity_score_values</code>
argument.</p>
<p>Providing the known propensity scores to the absolute TEM-VIP
estimators produces some desirable results. In the continuous and binary
outcome settings, providing known treatment assignment probabilities
guarantees that the estimators are asymptotically linear, even when the
expected conditional outcome estimator is misspecified. When the outcome
is a right-censored time-to-event variable, asymptotic normality of the
estimators is guaranteed so long as the conditional censoring hazard is
estimated consistently at a rate of <span class="math inline">\(n^{-1/4}\)</span>. Additional details and
discussions are provided in <span class="citation">Boileau et al.
(2022)</span> and <span class="citation">Boileau et al.
(2023)</span>.</p>
</div>
<div class="section level3">
<h3 id="cross-fitting">Cross-Fitting<a class="anchor" aria-label="anchor" href="#cross-fitting"></a>
</h3>
<p>Cross-fitting, popularized by <span class="citation">Zheng and van
der Laan (2011)</span> and <span class="citation">Chernozhukov et al.
(2017)</span>, uses cross-validation to fit the nuisance parameters and
estimate the target parameter. Doing so relaxes the entropy constraints
required for asymptotic normality of the one-step and TML estimators
implemented in the <code>unihtee</code> package. This technique is also
known to improve these estimators finite-sample properties, such as
reducing their false discovery rate (see, for example, <span class="citation">Hejazi et al.</span>).</p>
<p>Users may employ the cross-fitted version of any estimator
implemented in <code>unihtee</code> by setting <code><a href="../reference/unihtee.html">unihtee()</a></code>’s
<code>cross_fit</code> argument to <code>TRUE</code>. Only K-fold
cross-validation is currently supported. The number of folds defaults to
five, though this can be modified using the <code>cross_fit_folds</code>
argument. Examples are provided in the binary outcome and time-to-event
outcome relative TEM-VIP sections of this vignette, as well as in the
subsection on Super Learners that follows.</p>
</div>
<div class="section level3">
<h3 id="sl3-integration-using-super-learners">
<code>sl3</code> Integration: Using Super Learners<a class="anchor" aria-label="anchor" href="#sl3-integration-using-super-learners"></a>
</h3>
<p><code>unihtee</code> uses the estimators implemented in the
<code>sl3</code> <span class="citation">(Coyle et al. 2021)</span> to
estimate nuisance parameters. While individual estimators may be used,
as is done in the examples above, <code>sl3</code>’s main contribution
are facilities for constructing Super Learners <span class="citation">(Laan, Polley, and Hubbard 2007)</span>. Super Learners
are ensemble algorithms, meaning they are the convex combination of
individual supervised learning algorithms. These individual algorithms
are combined on the basis of a user-defined risk, and this combination
is asymptotically optimal with respect to said risk under minimal
conditions about the data-generating process. A complete review on Super
Learners and <code>sl3</code> is outside the scope of this vignette. We
invite the interested reader to the tutorials available on the
<code>sl3</code> package’s <a href="https://tlverse.org/sl3/" class="external-link">website</a> and in Chapter 6 of the <a href="https://tlverse.org/tlverse-handbook/sl3.html" class="external-link"><code>tlverse</code>
handbook</a> <span class="citation">(Phillips 2023)</span>.</p>
<p>Employing Super Learners to estimate nuisance parameters decreases
the risk of model-misspecification — assuming, of course, that a diverse
collection individual learning algorithms is considered. In turn, there
is an increased likelihood that the resulting one-step and TML
estimators are asymptotically normal.</p>
<p>We revisit our continuous outcome example, this time using Super
Learners to estimate the propensity score and the conditional expected
outcomes. Both Super Learners are composed of penalized GLMs,
multivariate adaptive regression splines <span class="citation">(Friedman 1991)</span>, and Random Forests. The
propensity score’s Super Learner uses the log loss to form the convex
combination of individual learning algorithms, while the conditional
expected outcomes’ uses the squared error loss. Additionally, we employ
2-fold cross-fitting.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate a random sample</span></span>
<span><span class="va">sample_df</span> <span class="op">&lt;-</span> <span class="fu">cont_outcome_dgp</span><span class="op">(</span>n_obs <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define the Super Learner for the propensity score</span></span>
<span><span class="va">sl_bin</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_sl.html" class="external-link">Lrnr_sl</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  learners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_earth.html" class="external-link">Lrnr_earth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>glm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_ranger.html" class="external-link">Lrnr_ranger</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metalearner <span class="op">=</span> <span class="fu"><a href="https://tlverse.org/sl3/reference/Lrnr_base.html" class="external-link">make_learner</a></span><span class="op">(</span></span>
<span>    <span class="va">Lrnr_solnp</span>, <span class="va">metalearner_logistic_binomial</span>,</span>
<span>    <span class="va">loss_squared_error</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define the Super Learner for the conditional expected outcomes</span></span>
<span><span class="va">sl_cont</span> <span class="op">&lt;-</span> <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_sl.html" class="external-link">Lrnr_sl</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  learners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>      formula <span class="op">=</span> <span class="st">"~ a * w_1 + a * w_2 + a * w_3 + a * w_4 + a * w_5"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      formula <span class="op">=</span> <span class="st">"~ a * w_1 + a * w_2 + a * w_3 + a * w_4 + a * w_5"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_glmnet.html" class="external-link">Lrnr_glmnet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>      formula <span class="op">=</span> <span class="st">"~ a * w_1 + a * w_2 + a * w_3 + a * w_4 + a * w_5"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_earth.html" class="external-link">Lrnr_earth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      glm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>,</span>
<span>      degree <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_earth.html" class="external-link">Lrnr_earth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      glm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>,</span>
<span>      degree <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_earth.html" class="external-link">Lrnr_earth</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      glm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>,</span>
<span>      formula <span class="op">=</span> <span class="st">"~ a * w_1 + a * w_2 + a * w_3 + a * w_4 + a * w_5"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://tlverse.org/sl3/reference/Lrnr_ranger.html" class="external-link">Lrnr_ranger</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  metalearner <span class="op">=</span> <span class="fu"><a href="https://tlverse.org/sl3/reference/Lrnr_base.html" class="external-link">make_learner</a></span><span class="op">(</span></span>
<span>    <span class="va">Lrnr_solnp</span>, <span class="va">metalearner_linear</span>, <span class="fu">sl3</span><span class="fu">::</span><span class="va"><a href="https://tlverse.org/sl3/reference/loss_functions.html" class="external-link">loss_squared_error</a></span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># one-step estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"onestep"</span>,</span>
<span>  cond_outcome_estimator <span class="op">=</span> <span class="va">sl_cont</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="va">sl_bin</span>,</span>
<span>  cross_fit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cross_fit_folds <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier    estimate         se          z   p_value    ci_lower  ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_2  1.01322541 0.10199927  9.9336537 0.0000000  0.81330684 1.2131440</span></span>
<span><span class="co">#&gt; 2:      w_3  1.98347638 0.13831712 14.3400640 0.0000000  1.71237482 2.2545779</span></span>
<span><span class="co">#&gt; 3:      w_4  0.15980553 0.09755231  1.6381522 0.1013899 -0.03139699 0.3510081</span></span>
<span><span class="co">#&gt; 4:      w_1 -0.01980657 0.10279772 -0.1926752 0.8472133 -0.22129010 0.1816770</span></span>
<span><span class="co">#&gt; 5:      w_5  0.01434656 0.09377386  0.1529911 0.8784053 -0.16945020 0.1981433</span></span>
<span><span class="co">#&gt;    p_value_fdr</span></span>
<span><span class="co">#&gt; 1:   0.0000000</span></span>
<span><span class="co">#&gt; 2:   0.0000000</span></span>
<span><span class="co">#&gt; 3:   0.1689832</span></span>
<span><span class="co">#&gt; 4:   0.8784053</span></span>
<span><span class="co">#&gt; 5:   0.8784053</span></span>
<span></span>
<span><span class="co"># TML estimator</span></span>
<span><span class="fu"><a href="../reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sample_df</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  modifiers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"w_1"</span>, <span class="st">"w_2"</span>, <span class="st">"w_3"</span>, <span class="st">"w_4"</span>, <span class="st">"w_5"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span>,</span>
<span>  cond_outcome_estimator <span class="op">=</span> <span class="va">sl_cont</span>,</span>
<span>  prop_score_estimator <span class="op">=</span> <span class="va">sl_bin</span>,</span>
<span>  cross_fit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cross_fit_folds <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    modifier    estimate         se          z   p_value   ci_lower  ci_upper</span></span>
<span><span class="co">#&gt; 1:      w_2  0.98762264 0.10454871  9.4465311 0.0000000  0.7827072 1.1925381</span></span>
<span><span class="co">#&gt; 2:      w_3  1.98247437 0.13797716 14.3681347 0.0000000  1.7120391 2.2529096</span></span>
<span><span class="co">#&gt; 3:      w_4  0.15711411 0.09755985  1.6104382 0.1073022 -0.0341032 0.3483314</span></span>
<span><span class="co">#&gt; 4:      w_1 -0.03473531 0.10365604 -0.3351016 0.7375484 -0.2379011 0.1684305</span></span>
<span><span class="co">#&gt; 5:      w_5  0.01402747 0.09395342  0.1493024 0.8813150 -0.1701212 0.1981762</span></span>
<span><span class="co">#&gt;    p_value_fdr</span></span>
<span><span class="co">#&gt; 1:   0.0000000</span></span>
<span><span class="co">#&gt; 2:   0.0000000</span></span>
<span><span class="co">#&gt; 3:   0.1788371</span></span>
<span><span class="co">#&gt; 4:   0.8813150</span></span>
<span><span class="co">#&gt; 5:   0.8813150</span></span></code></pre></div>
<p>Though this procedure is more robust, the resulting estimates and
hypothesis tests are to those of the previous continuous outcome,
absolute TEM-VIP example.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] unihtee_0.0.1      earth_5.3.2        plotmo_3.6.2       TeachingDemos_2.12</span></span>
<span><span class="co">#&gt;  [5] plotrix_3.8-2      Formula_1.2-5      ranger_0.15.1      xgboost_1.7.5.1   </span></span>
<span><span class="co">#&gt;  [9] glmnet_4.1-7       Matrix_1.5-4       Rsolnp_1.16        sl3_1.4.4         </span></span>
<span><span class="co">#&gt; [13] dplyr_1.1.1       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] colorspace_2.1-0     class_7.3-21         rprojroot_2.0.3     </span></span>
<span><span class="co">#&gt;   [4] fs_1.6.1             listenv_0.9.0        prodlim_2023.03.31  </span></span>
<span><span class="co">#&gt;   [7] fansi_1.0.4          lubridate_1.9.2      codetools_0.2-19    </span></span>
<span><span class="co">#&gt;  [10] splines_4.2.2        R.methodsS3_1.8.2    cachem_1.0.7        </span></span>
<span><span class="co">#&gt;  [13] knitr_1.42           jsonlite_1.8.4       pROC_1.18.0         </span></span>
<span><span class="co">#&gt;  [16] caret_6.0-94         R.oo_1.25.0          compiler_4.2.2      </span></span>
<span><span class="co">#&gt;  [19] backports_1.4.1      assertthat_0.2.1     fastmap_1.1.1       </span></span>
<span><span class="co">#&gt;  [22] rstackdeque_1.1.1    cli_3.6.1            visNetwork_2.1.2    </span></span>
<span><span class="co">#&gt;  [25] htmltools_0.5.5      prettyunits_1.1.1    tools_4.2.2         </span></span>
<span><span class="co">#&gt;  [28] igraph_1.4.2         gtable_0.3.3         glue_1.6.2          </span></span>
<span><span class="co">#&gt;  [31] reshape2_1.4.4       Rcpp_1.0.10          jquerylib_0.1.4     </span></span>
<span><span class="co">#&gt;  [34] pkgdown_2.0.7        vctrs_0.6.1          nlme_3.1-162        </span></span>
<span><span class="co">#&gt;  [37] iterators_1.0.14     timeDate_4022.108    origami_1.0.7       </span></span>
<span><span class="co">#&gt;  [40] gower_1.0.1          xfun_0.38            stringr_1.5.0       </span></span>
<span><span class="co">#&gt;  [43] globals_0.16.2       rbibutils_2.2.13     delayed_0.4.0       </span></span>
<span><span class="co">#&gt;  [46] timechange_0.2.0     lifecycle_1.0.3      future_1.32.0       </span></span>
<span><span class="co">#&gt;  [49] MASS_7.3-58.3        scales_1.2.1         ipred_0.9-14        </span></span>
<span><span class="co">#&gt;  [52] ragg_1.2.5           hms_1.1.3            parallel_4.2.2      </span></span>
<span><span class="co">#&gt;  [55] BBmisc_1.13          yaml_2.3.7           memoise_2.0.1       </span></span>
<span><span class="co">#&gt;  [58] ggplot2_3.4.2        sass_0.4.5           rpart_4.1.19        </span></span>
<span><span class="co">#&gt;  [61] stringi_1.7.12       desc_1.4.2           foreach_1.5.2       </span></span>
<span><span class="co">#&gt;  [64] randomForest_4.7-1.1 checkmate_2.1.0      hardhat_1.3.0       </span></span>
<span><span class="co">#&gt;  [67] lava_1.7.2.1         truncnorm_1.0-9      shape_1.4.6         </span></span>
<span><span class="co">#&gt;  [70] Rdpack_2.4           rlang_1.1.0          pkgconfig_2.0.3     </span></span>
<span><span class="co">#&gt;  [73] systemfonts_1.0.4    evaluate_0.20        lattice_0.21-8      </span></span>
<span><span class="co">#&gt;  [76] ROCR_1.0-11          purrr_1.0.1          recipes_1.0.5       </span></span>
<span><span class="co">#&gt;  [79] htmlwidgets_1.6.2    tidyselect_1.2.0     parallelly_1.35.0   </span></span>
<span><span class="co">#&gt;  [82] plyr_1.8.8           magrittr_2.0.3       R6_2.5.1            </span></span>
<span><span class="co">#&gt;  [85] generics_0.1.3       pillar_1.9.0         withr_2.5.0         </span></span>
<span><span class="co">#&gt;  [88] survival_3.5-5       abind_1.4-5          nnet_7.3-18         </span></span>
<span><span class="co">#&gt;  [91] tibble_3.2.1         future.apply_1.10.0  crayon_1.5.2        </span></span>
<span><span class="co">#&gt;  [94] uuid_1.1-0           utf8_1.2.3           rmarkdown_2.21      </span></span>
<span><span class="co">#&gt;  [97] imputeMissings_0.0.3 progress_1.2.2       grid_4.2.2          </span></span>
<span><span class="co">#&gt; [100] data.table_1.14.8    ModelMetrics_1.2.2.2 digest_0.6.31       </span></span>
<span><span class="co">#&gt; [103] R.utils_2.12.2       textshaping_0.3.6    stats4_4.2.2        </span></span>
<span><span class="co">#&gt; [106] munsell_0.5.0        bslib_0.4.2</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bahamyirou2022" class="csl-entry">
Bahamyirou, Asma, Mireille E. Schnitzer, Edward H. Kennedy, Lucie Blais,
and Yi Yang. 2022. <span>“Doubly Robust Adaptive LASSO for Effect
Modifier Discovery.”</span> <em>The International Journal of
Biostatistics</em>. <a href="https://doi.org/doi:10.1515/ijb-2020-0073" class="external-link">https://doi.org/doi:10.1515/ijb-2020-0073</a>.
</div>
<div id="ref-boileau2023" class="csl-entry">
Boileau, Philippe, Ning Leng, Nima Hejazi, Mark J van der Laan, and
Sandrine Dudoit. 2023. <span>“<a href="">A Nonparametric Framework for
Treatment Effect Modifier Discovery in High Dimensions</a>.”</span>
arXiv.
</div>
<div id="ref-boileau2022" class="csl-entry">
Boileau, Philippe, Nina Ting Qi, Mark J van der Laan, Sandrine Dudoit,
and Ning Leng. 2022. <span>“<span class="nocase">A flexible approach for
predictive biomarker discovery</span>.”</span> <em>Biostatistics</em>,
July. <a href="https://doi.org/10.1093/biostatistics/kxac029" class="external-link">https://doi.org/10.1093/biostatistics/kxac029</a>.
</div>
<div id="ref-breiman2001" class="csl-entry">
Breiman, Leo. 2001. <span>“Random Forests.”</span> <em>Machine
Learning</em> 45 (1): 5–32.
</div>
<div id="ref-chen2017" class="csl-entry">
Chen, Shuai, Lu Tian, Tianxi Cai, and Menggang Yu. 2017. <span>“A
General Statistical Framework for Subgroup Identification and
Comparative Treatment Scoring.”</span> <em>Biometrics</em> 73 (4):
1199–209. https://doi.org/<a href="https://doi.org/10.1111/biom.12676" class="external-link">https://doi.org/10.1111/biom.12676</a>.
</div>
<div id="ref-chen2016" class="csl-entry">
Chen, Tianqi, and Carlos Guestrin. 2016. <span>“<span>XGBoost</span>: A
Scalable Tree Boosting System.”</span> In <em>Proceedings of the 22nd
ACM SIGKDD International Conference on Knowledge Discovery and Data
Mining</em>, 785–94. KDD ’16. New York, NY, USA: ACM. <a href="https://doi.org/10.1145/2939672.2939785" class="external-link">https://doi.org/10.1145/2939672.2939785</a>.
</div>
<div id="ref-cherno2017" class="csl-entry">
Chernozhukov, Victor, Denis Chetverikov, Mert Demirer, Esther Duflo,
Christian Hansen, and Whitney Newey. 2017. <span>“Double/Debiased/Neyman
Machine Learning of Treatment Effects.”</span> <em>American Economic
Review</em> 107 (5): 261–65. <a href="https://doi.org/10.1257/aer.p20171038" class="external-link">https://doi.org/10.1257/aer.p20171038</a>.
</div>
<div id="ref-coyle2021sl3-rpkg" class="csl-entry">
Coyle, Jeremy R, Nima S Hejazi, Ivana Malenica, Rachael V Phillips, and
Oleg Sofrygin. 2021. <em><span class="nocase">sl3</span>: Modern
Pipelines for Machine Learning and <span>Super Learning</span></em>. <a href="https://github.com/tlverse/sl3" class="external-link uri">https://github.com/tlverse/sl3</a>. <a href="https://doi.org/10.5281/zenodo.1342293" class="external-link">https://doi.org/10.5281/zenodo.1342293</a>.
</div>
<div id="ref-cui2022" class="csl-entry">
Cui, Yifan, Michael R. Kosorok, Erik Sverdrup, Stefan Wager, and Ruoqing
Zhu. 2022. arXiv. <a href="https://doi.org/10.48550/ARXIV.2001.09887" class="external-link">https://doi.org/10.48550/ARXIV.2001.09887</a>.
</div>
<div id="ref-friedman1991" class="csl-entry">
Friedman, Jerome H. 1991. <span>“<span>Multivariate Adaptive Regression
Splines</span>.”</span> <em>The Annals of Statistics</em> 19 (1): 1–67.
</div>
<div id="ref-esl2009" class="csl-entry">
Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The
Elements of Statistical Learning: Data Mining, Inference and
Prediction</em>. 2nd ed. Springer. <a href="http://www-stat.stanford.edu/~tibs/ElemStatLearn/" class="external-link">http://www-stat.stanford.edu/~tibs/ElemStatLearn/</a>.
</div>
<div id="ref-hejazi2022" class="csl-entry">
Hejazi, Nima S, Philippe Boileau, Mark J van der Laan, and Alan E
Hubbard. <span>“A Generalization of Moderated Statistics to Data
Adaptive Semiparametric Estimation in High-Dimensional Biology.”</span>
<em>Statistical Methods in Medical Research</em> 0 (0):
09622802221146313.
</div>
<div id="ref-hines2022TEVIP" class="csl-entry">
Hines, Oliver, Karla Diaz-Ordaz, and Stijn Vansteelandt. 2022.
<span>“Variable Importance Measures for Heterogeneous Causal
Effects.”</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2204.06030" class="external-link">https://doi.org/10.48550/ARXIV.2204.06030</a>.
</div>
<div id="ref-vdl2007" class="csl-entry">
Laan, Mark J. van der, Eric C Polley, and Alan E. Hubbard. 2007.
<span>“Super Learner.”</span> <em>Statistical Applications in Genetics
and Molecular Biology</em> 6 (1). <a href="https://doi.org/doi:10.2202/1544-6115.1309" class="external-link">https://doi.org/doi:10.2202/1544-6115.1309</a>.
</div>
<div id="ref-tlverse-sl3" class="csl-entry">
Phillips, Rachael. 2023. <span>“Targeted Learning in <span>R</span>:
Causal Data Science with the <span class="nocase">tlverse</span>
Software Ecosystem.”</span> In. <a href="https://tlverse.org/tlverse-handbook/sl3.html" class="external-link">https://tlverse.org/tlverse-handbook/sl3.html</a>.
</div>
<div id="ref-rubin1974" class="csl-entry">
Rubin, D. B. 1974. <span>“Estimating Causal Effects of Treatments in
Randomized and Nonrandomized Studies.”</span> <em>Journal of Educational
Psychology</em> 66 (5): 688–701.
</div>
<div id="ref-semenova2021" class="csl-entry">
Semenova, Vira, and Victor Chernozhukov. 2020. <span>“<span class="nocase">Debiased machine learning of conditional average
treatment effects and other causal functions</span>.”</span> <em>The
Econometrics Journal</em> 24 (2): 264–89. <a href="https://doi.org/10.1093/ectj/utaa027" class="external-link">https://doi.org/10.1093/ectj/utaa027</a>.
</div>
<div id="ref-tian2014" class="csl-entry">
Tian, Lu, Ash A. Alizadeh, Andrew J. Gentles, and Robert Tibshirani.
2014. <span>“A Simple Method for Estimating Interactions Between a
Treatment and a Large Number of Covariates.”</span> <em>Journal of the
American Statistical Association</em> 109 (508): 1517–32. <a href="https://doi.org/10.1080/01621459.2014.951443" class="external-link">https://doi.org/10.1080/01621459.2014.951443</a>.
</div>
<div id="ref-tibshirani1996" class="csl-entry">
Tibshirani, Robert. 1996. <span>“Regression Shrinkage and Selection via
the Lasso.”</span> <em>Journal of the Royal Statistical Society. Series
B (Methodological)</em> 58 (1): 267–88. <a href="http://www.jstor.org/stable/2346178" class="external-link">http://www.jstor.org/stable/2346178</a>.
</div>
<div id="ref-wager2018" class="csl-entry">
Wager, Stefan, and Susan Athey. 2018. <span>“Estimation and Inference of
Heterogeneous Treatment Effects Using Random Forests.”</span>
<em>Journal of the American Statistical Association</em> 113 (523):
1228–42. <a href="https://doi.org/10.1080/01621459.2017.1319839" class="external-link">https://doi.org/10.1080/01621459.2017.1319839</a>.
</div>
<div id="ref-williamson2022framework" class="csl-entry">
Williamson, Brian D., Peter B. Gilbert, Noah R. Simon, and Marco Carone.
2022. <span>“A General Framework for Inference on Algorithm-Agnostic
Variable Importance.”</span> <em>Journal of the American Statistical
Association</em> 0 (0): 1–14.
</div>
<div id="ref-ranger" class="csl-entry">
Wright, Marvin N., and Andreas Ziegler. 2017. <span>“Ranger: A Fast
Implementation of Random Forests for High Dimensional Data in c++ and
r.”</span> <em>Journal of Statistical Software</em> 77 (1): 1–17.
</div>
<div id="ref-zhao2006" class="csl-entry">
Zhao, Peng, and Bin Yu. 2006. <span>“On Model Selection Consistency of
Lasso.”</span> <em>Journal of Machine Learning Research</em> 7 (90):
2541–63. <a href="http://jmlr.org/papers/v7/zhao06a.html" class="external-link">http://jmlr.org/papers/v7/zhao06a.html</a>.
</div>
<div id="ref-zhao2018" class="csl-entry">
Zhao, Qingyuan, Dylan S. Small, and Ashkan Ertefaie. 2018.
<span>“Selective Inference for Effect Modification via the
Lasso.”</span> <a href="https://arxiv.org/abs/1705.08020" class="external-link">https://arxiv.org/abs/1705.08020</a>.
</div>
<div id="ref-zheng2011cross" class="csl-entry">
Zheng, Wenjing, and Mark J van der Laan. 2011. <span>“Cross-Validated
Targeted Minimum-Loss-Based Estimation.”</span> In <em>Targeted
Learning: Causal Inference for Observational and Experimental Data</em>,
459–74. Springer.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Philippe Boileau.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
