<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Univariate Heterogeneous Treatment Effect Estimation • unihtee</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Univariate Heterogeneous Treatment Effect Estimation">
<meta name="description" content="unihtee implements nonparametric inference procedures for treatment effect modification variable importance parameters. These variable importance parameters reflect individual confounders\' capacity for treatment effect modification and are suited for high-dimensional data with potentially complex correlation structures.">
<meta property="og:description" content="unihtee implements nonparametric inference procedures for treatment effect modification variable importance parameters. These variable importance parameters reflect individual confounders\' capacity for treatment effect modification and are suited for high-dimensional data with potentially complex correlation structures.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">unihtee</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/using-unihtee.html">Using unihtee</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="runihtee">R/<code>unihtee</code>
<a class="anchor" aria-label="anchor" href="#runihtee"></a>
</h1></div>
<blockquote>
<p>Univariate Heterogeneous Treatment Effect Estimation</p>
</blockquote>
<p><strong>Author:</strong> <a href="https://pboileau.ca/" class="external-link">Philippe Boileau</a></p>
<!-- badges: start -->

<hr>
<p><code>unihtee</code> provides tools for uncovering treatment effect modifiers in high-dimensional data. Treatment effect modification is defined using variable importance parameters based on absolute and relative effects. Inference is performed about these variable importance measures using nonparametric estimators. Users may use one-step or targeted maximum likelihood estimators. Under general conditions, these estimators are unbiased and efficient.</p>
<p>Additional details about this methodology are provided in Boileau et al. (2022), Boileau et al. (2025), and in the package’s <a href="https://insightsengineering.github.io/unihtee/main/articles/using-unihtee.html">vignette</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package may be installed from GitHub using <a href="https://CRAN.R-project.org/package=remotes" class="external-link"><code>remotes</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"insightsengineering/unihtee"</span><span class="op">)</span></span></code></pre></div>
<p><code>unihtee</code> is under active development. Check back often for updates.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p><code><a href="reference/unihtee.html">unihtee()</a></code> is the only user-facing function. It can be used to perform inference about the treatment effect modification variable importance parameters. These parameters are defined for data-generating processes with continuous, binary and time-to-event outcomes with binary exposure variables. Variable importance parameters based on absolute and relative effects are available. Details are provided in the vignette.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We simulate some observational study data that contains ten pre-treatment covariates, of which are two treatment effect modifiers. We then perform inference about the absolute treatment effect modifier variable importance parameter, which is inspired by the average treatment effect.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">unihtee</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">510</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the dataset</span></span>
<span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">confounder_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"w_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">confounder_names</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mean <span class="op">=</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">a</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># targeted maximum likelihood estimates and testing procedure</span></span>
<span><span class="fu"><a href="reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dt</span>,</span>
<span>  confounders <span class="op">=</span> <span class="va">confounder_names</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="va">confounder_names</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     modifier     estimate        se           z      p_value    ci_lower</span></span>
<span><span class="co">#&gt;       &lt;fctr&gt;        &lt;num&gt;     &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:      w_3  1.044592804 0.1599527  6.53063474 6.549161e-11  0.73108547</span></span>
<span><span class="co">#&gt;  2:      w_4 -0.869002514 0.1505155 -5.77351005 7.763697e-09 -1.16401281</span></span>
<span><span class="co">#&gt;  3:      w_8  0.137803254 0.1138565  1.21032372 2.261547e-01 -0.08535554</span></span>
<span><span class="co">#&gt;  4:      w_1  0.115258422 0.1168820  0.98610900 3.240796e-01 -0.11383036</span></span>
<span><span class="co">#&gt;  5:      w_9  0.124150185 0.1295567  0.95826884 3.379272e-01 -0.12978102</span></span>
<span><span class="co">#&gt;  6:     w_10 -0.097928234 0.1356345 -0.72200119 4.702937e-01 -0.36377176</span></span>
<span><span class="co">#&gt;  7:      w_6  0.054845105 0.1157812  0.47369617 6.357166e-01 -0.17208602</span></span>
<span><span class="co">#&gt;  8:      w_2 -0.064478504 0.1761998 -0.36593963 7.144101e-01 -0.40983019</span></span>
<span><span class="co">#&gt;  9:      w_7 -0.014704981 0.1485610 -0.09898279 9.211519e-01 -0.30588450</span></span>
<span><span class="co">#&gt; 10:      w_5  0.001500152 0.1100365  0.01363321 9.891226e-01 -0.21417147</span></span>
<span><span class="co">#&gt;       ci_upper  p_value_fdr</span></span>
<span><span class="co">#&gt;          &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:  1.3581001 6.549161e-10</span></span>
<span><span class="co">#&gt;  2: -0.5739922 3.881849e-08</span></span>
<span><span class="co">#&gt;  3:  0.3609620 6.758544e-01</span></span>
<span><span class="co">#&gt;  4:  0.3443472 6.758544e-01</span></span>
<span><span class="co">#&gt;  5:  0.3780814 6.758544e-01</span></span>
<span><span class="co">#&gt;  6:  0.1679153 7.838229e-01</span></span>
<span><span class="co">#&gt;  7:  0.2817762 8.930127e-01</span></span>
<span><span class="co">#&gt;  8:  0.2808732 8.930127e-01</span></span>
<span><span class="co">#&gt;  9:  0.2764745 9.891226e-01</span></span>
<span><span class="co">#&gt; 10:  0.2171718 9.891226e-01</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="issues">Issues<a class="anchor" aria-label="anchor" href="#issues"></a>
</h2>
<p>If you encounter any bugs or have any specific feature requests, please <a href="https://github.com/insightsengineering/unihtee/issues" class="external-link">file an issue</a>.</p>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<p>Contributions are very welcome. Interested contributors should consult our <a href="https://github.com/insightsengineering/unihtee/blob/master/.github/CONTRIBUTING.md" class="external-link">contribution guidelines</a> prior to submitting a pull request.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>To cite <code>unihtee</code> and the papers introducing the underlying framework, use the following BibTeX entries:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="sc">@</span>manual{unihtee,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  title <span class="ot">=</span> {unihtee<span class="sc">:</span> Univariate Heterogeneous Treatment Effect Estimation},</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  author <span class="ot">=</span> {Philippe Boileau},</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  note <span class="ot">=</span> {R package version <span class="dv">0</span>.<span class="fl">0.1</span>}</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="sc">@</span>article{boileau2025,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  title <span class="ot">=</span> {A Nonparametric Framework <span class="cf">for</span> Treatment Effect Modifier Discovery <span class="cf">in</span> High Dimensions},</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  author <span class="ot">=</span> {Boileau, Philippe and Leng, Ning and Hejazi, Nima S and {van der Laan}, Mark and Dudoit, Sandrine},</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  year <span class="ot">=</span> {<span class="dv">2025</span>},</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  journal <span class="ot">=</span> {Journal of the Royal Statistical Society Series B<span class="sc">:</span> Statistical Methodology},</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  volume <span class="ot">=</span> {<span class="dv">87</span>},</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  number <span class="ot">=</span> {<span class="dv">1</span>},</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  pages <span class="ot">=</span> {<span class="dv">157</span><span class="sc">--</span><span class="dv">185</span>},</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  issn <span class="ot">=</span> {<span class="dv">1369-7412</span>},</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  doi <span class="ot">=</span> {<span class="fl">10.1093</span><span class="sc">/</span>jrsssb<span class="sc">/</span>qkae084}</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>}</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="sc">@</span>article{boileau2022,</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>  author <span class="ot">=</span> {Boileau, Philippe and Qi, Nina Ting and van der Laan, Mark J and Dudoit, Sandrine and Leng, Ning},</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  title <span class="ot">=</span> {A flexible approach <span class="cf">for</span> predictive biomarker discovery},</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  journal <span class="ot">=</span> {Biostatistics},</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  year <span class="ot">=</span> {<span class="dv">2022</span>},</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>  month <span class="ot">=</span> {<span class="dv">07</span>},</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  issn <span class="ot">=</span> {<span class="dv">1465-4644</span>},</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>  doi <span class="ot">=</span> {<span class="fl">10.1093</span><span class="sc">/</span>biostatistics<span class="sc">/</span>kxac029},</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>  url <span class="ot">=</span> {https<span class="sc">:</span><span class="er">//</span>doi.org<span class="sc">/</span><span class="fl">10.1093</span><span class="sc">/</span>biostatistics<span class="sc">/</span>kxac029}</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>The contents of this repository are distributed under the Apache 2.0 license. See the <a href="https://github.com/insightsengineering/unihtee/blob/main/LICENSE.md" class="external-link"><code>LICENSE.md</code></a> and <a href="https://github.com/insightsengineering/unihtee/blob/main/LICENSE" class="external-link"><code>LICENSE</code></a> files for details.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-boileau2023" class="csl-entry">
Boileau, Philippe, Ning Leng, Nima S Hejazi, Mark van der Laan, and Sandrine Dudoit. 2025. “A Nonparametric Framework for Treatment Effect Modifier Discovery in High Dimensions.” <em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>. <a href="https://doi.org/10.1093/jrsssb/qkae084" class="external-link uri">https://doi.org/10.1093/jrsssb/qkae084</a>.
</div>
<div id="ref-boileau2022" class="csl-entry">
Boileau, Philippe, Nina Ting Qi, Mark J van der Laan, Sandrine Dudoit, and Ning Leng. 2022. “<span class="nocase">A flexible approach for predictive biomarker discovery</span>.” <em>Biostatistics</em>, July. <a href="https://doi.org/10.1093/biostatistics/kxac029" class="external-link uri">https://doi.org/10.1093/biostatistics/kxac029</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing unihtee</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Philippe Boileau <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4850-2507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Philippe Boileau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
