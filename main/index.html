<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Univariate Heterogeneous Treatment Effect Estimation â€¢ unihtee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Univariate Heterogeneous Treatment Effect Estimation">
<meta property="og:description" content="unihtee implements nonparametreic inference procedures for
  treatment effect modifition variable importance parameters. These variable
  importance parameters reflect individual confounders\' capacity for treatment
  effect modification and are suited for high-dimensional data with potentially
  complex correlation structures.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">unihtee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/using-unihtee.html">Using `unihtee`</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="runihtee">
<code>R</code>/<code>unihtee</code>
<a class="anchor" aria-label="anchor" href="#runihtee"></a>
</h1></div>
<blockquote>
<p>Univariate Heterogeneous Treatment Effect Estimation</p>
</blockquote>
<p><strong>Author:</strong> <a href="https://pboileau.ca/" class="external-link">Philippe Boileau</a></p>
<!-- badges: start -->
<!-- badges: end -->
<hr>
<p><code>unicate</code> provides tools for uncovering treatment effect modifiers in high-dimensional data. Treatment effect modification is defined using variable importance parameters based on absolute and relative scales. The variable importance parameters are model-agnostic, meaning they do not depend on specific regression pocedures (for example, the variable importance measures of Random Forests). Inference is performed about these variable importance measures using nonparametric estimators. Users may use one-step or targeted maximum likelihood estimators. Under general conditions, these estimators are unbiased and efficient.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package may be installed from GitHub using <a href="https://CRAN.R-project.org/package=remotes" class="external-link"><code>remotes</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"insightsengineering/unihtee"</span><span class="op">)</span></span></code></pre></div>
<p><code>unihtee</code> is under active development. Check back often for updates.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p><code><a href="reference/unihtee.html">unihtee()</a></code> is the only user-facing function. It can be used to perform inference about the treatment effect modification variable importance parameters. These parameters are defined for use with continuous, binary and time-to-event outcomes with binary exposure variables. Variable importance parameters are defined on both the absolute and relative scales.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We simulate some observational study data that contains ten confounders, of which are two treatment effect modifiers. We then perform inference about the absolute scale variable importance parameter.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">unihtee</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">510</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create the dataset</span></span>
<span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">confounder_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"w_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">confounder_names</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mean <span class="op">=</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">a</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## targeted maximum likelihood estimates and testing procedure</span></span>
<span><span class="fu"><a href="reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dt</span>,</span>
<span>  confounders <span class="op">=</span> <span class="va">confounder_names</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="va">confounder_names</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     modifier    estimate        se          z      p_value    ci_lower</span></span>
<span><span class="co">#&gt;  1:      w_3  1.19657424 0.1613233  7.4172461 1.196820e-13  0.88038067</span></span>
<span><span class="co">#&gt;  2:      w_4 -0.89218696 0.1492369 -5.9783268 2.254412e-09 -1.18469128</span></span>
<span><span class="co">#&gt;  3:      w_8  0.19677508 0.1137877  1.7293170 8.375237e-02 -0.02624889</span></span>
<span><span class="co">#&gt;  4:      w_1  0.19352745 0.1160698  1.6673368 9.544745e-02 -0.03396935</span></span>
<span><span class="co">#&gt;  5:     w_10 -0.11398276 0.1356947 -0.8399945 4.009115e-01 -0.37994429</span></span>
<span><span class="co">#&gt;  6:      w_9  0.10749149 0.1300309  0.8266613 4.084291e-01 -0.14736901</span></span>
<span><span class="co">#&gt;  7:      w_6  0.07756350 0.1159920  0.6686969 5.036888e-01 -0.14978083</span></span>
<span><span class="co">#&gt;  8:      w_2 -0.08609331 0.1767372 -0.4871262 6.261689e-01 -0.43249814</span></span>
<span><span class="co">#&gt;  9:      w_7 -0.01905859 0.1485309 -0.1283140 8.979005e-01 -0.31017921</span></span>
<span><span class="co">#&gt; 10:      w_5  0.00176980 0.1103689  0.0160353 9.872062e-01 -0.21455333</span></span>
<span><span class="co">#&gt;       ci_upper  p_value_fdr</span></span>
<span><span class="co">#&gt;  1:  1.5127678 1.196820e-12</span></span>
<span><span class="co">#&gt;  2: -0.5996826 1.127206e-08</span></span>
<span><span class="co">#&gt;  3:  0.4197991 2.386186e-01</span></span>
<span><span class="co">#&gt;  4:  0.4210242 2.386186e-01</span></span>
<span><span class="co">#&gt;  5:  0.1519788 6.807151e-01</span></span>
<span><span class="co">#&gt;  6:  0.3623520 6.807151e-01</span></span>
<span><span class="co">#&gt;  7:  0.3049078 7.195555e-01</span></span>
<span><span class="co">#&gt;  8:  0.2603115 7.827111e-01</span></span>
<span><span class="co">#&gt;  9:  0.2720620 9.872062e-01</span></span>
<span><span class="co">#&gt; 10:  0.2180929 9.872062e-01</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="issues">Issues<a class="anchor" aria-label="anchor" href="#issues"></a>
</h2>
<p>If you encounter any bugs or have any specific feature requests, please <a href="https://github.com/insightsengineering/unihtee/issues" class="external-link">file an issue</a>.</p>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<p>Contributions are very welcome. Interested contributors should consult our <a href="https://github.com/insightsengineering/unihtee/blob/master/.github/CONTRIBUTING.md" class="external-link">contribution guidelines</a> prior to submitting a pull request.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>The contents of this repository are distributed under the Apache 2.0 license. See the <a href="https://github.com/insightsengineering/unihtee/blob/main/LICENSE.md" class="external-link"><code>LICENSE.md</code></a> and <a href="https://github.com/insightsengineering/unihtee/blob/main/LICENSE" class="external-link"><code>LICENSE</code></a> files for details.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing unihtee</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Philippe Boileau <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4850-2507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Philippe Boileau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
