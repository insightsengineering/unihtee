<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unihtee implements nonparametric inference procedures for
  treatment effect modification variable importance parameters. These variable
  importance parameters reflect individual confounders\' capacity for treatment
  effect modification and are suited for high-dimensional data with potentially
  complex correlation structures.">
<title>Univariate Heterogeneous Treatment Effect Estimation • unihtee</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Univariate Heterogeneous Treatment Effect Estimation">
<meta property="og:description" content="unihtee implements nonparametric inference procedures for
  treatment effect modification variable importance parameters. These variable
  importance parameters reflect individual confounders\' capacity for treatment
  effect modification and are suited for high-dimensional data with potentially
  complex correlation structures.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">unihtee</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/using-unihtee.html">Using unihtee</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="runihtee">R/<code>unihtee</code>
<a class="anchor" aria-label="anchor" href="#runihtee"></a>
</h1></div>
<blockquote>
<p>Univariate Heterogeneous Treatment Effect Estimation</p>
</blockquote>
<p><strong>Author:</strong> <a href="https://pboileau.ca/" class="external-link">Philippe Boileau</a></p>
<!-- badges: start -->

<hr>
<p><code>unihtee</code> provides tools for uncovering treatment effect modifiers in high-dimensional data. Treatment effect modification is defined using variable importance parameters based on absolute and relative effects. Inference is performed about these variable importance measures using nonparametric estimators. Users may use one-step or targeted maximum likelihood estimators. Under general conditions, these estimators are unbiased and efficient.</p>
<p>Additional details about this methodology is provided in Boileau et al. (2022) and in the package’s <a href="https://insightsengineering.github.io/unihtee/main/articles/using-unihtee.html" class="external-link">vignette</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package may be installed from GitHub using <a href="https://CRAN.R-project.org/package=remotes" class="external-link"><code>remotes</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"insightsengineering/unihtee"</span><span class="op">)</span></span></code></pre></div>
<p><code>unihtee</code> is under active development. Check back often for updates.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p><code><a href="reference/unihtee.html">unihtee()</a></code> is the only user-facing function. It can be used to perform inference about the treatment effect modification variable importance parameters. These parameters are defined for data-generating processes with continuous, binary and time-to-event outcomes with binary exposure variables. Variable importance parameters based on absolute and relative effects are available. Details are provided in the vignette.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We simulate some observational study data that contains ten pre-treatment covariates, of which are two treatment effect modifiers. We then perform inference about the absolute treatment effect modifier variable importance parameter, which is inspired by the average treatment effect.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">unihtee</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">510</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create the dataset</span></span>
<span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">confounder_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"w_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">confounder_names</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_obs</span>, mean <span class="op">=</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">a</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## targeted maximum likelihood estimates and testing procedure</span></span>
<span><span class="fu"><a href="reference/unihtee.html">unihtee</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dt</span>,</span>
<span>  confounders <span class="op">=</span> <span class="va">confounder_names</span>,</span>
<span>  modifiers <span class="op">=</span> <span class="va">confounder_names</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"a"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  effect <span class="op">=</span> <span class="st">"absolute"</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"tmle"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     modifier     estimate        se           z      p_value    ci_lower</span></span>
<span><span class="co">#&gt;  1:      w_3  1.044592804 0.1613285  6.47494319 9.484769e-11  0.72838896</span></span>
<span><span class="co">#&gt;  2:      w_4 -0.869002514 0.1492388 -5.82289742 5.783606e-09 -1.16151066</span></span>
<span><span class="co">#&gt;  3:      w_8  0.137803254 0.1137965  1.21096238 2.259098e-01 -0.08523784</span></span>
<span><span class="co">#&gt;  4:      w_1  0.115258422 0.1160997  0.99275414 3.208298e-01 -0.11229692</span></span>
<span><span class="co">#&gt;  5:      w_9  0.124150185 0.1300374  0.95472664 3.397160e-01 -0.13072315</span></span>
<span><span class="co">#&gt;  6:     w_10 -0.097928234 0.1356976 -0.72166517 4.705004e-01 -0.36389554</span></span>
<span><span class="co">#&gt;  7:      w_6  0.054845105 0.1159964  0.47281713 6.363437e-01 -0.17250792</span></span>
<span><span class="co">#&gt;  8:      w_2 -0.064478504 0.1767632 -0.36477331 7.152806e-01 -0.41093441</span></span>
<span><span class="co">#&gt;  9:      w_7 -0.014704981 0.1485331 -0.09900136 9.211372e-01 -0.30582989</span></span>
<span><span class="co">#&gt; 10:      w_5  0.001500152 0.1103752  0.01359138 9.891560e-01 -0.21483526</span></span>
<span><span class="co">#&gt;       ci_upper  p_value_fdr</span></span>
<span><span class="co">#&gt;  1:  1.3607966 9.484769e-10</span></span>
<span><span class="co">#&gt;  2: -0.5764944 2.891803e-08</span></span>
<span><span class="co">#&gt;  3:  0.3608444 6.794319e-01</span></span>
<span><span class="co">#&gt;  4:  0.3428138 6.794319e-01</span></span>
<span><span class="co">#&gt;  5:  0.3790235 6.794319e-01</span></span>
<span><span class="co">#&gt;  6:  0.1680391 7.841673e-01</span></span>
<span><span class="co">#&gt;  7:  0.2821981 8.941008e-01</span></span>
<span><span class="co">#&gt;  8:  0.2819774 8.941008e-01</span></span>
<span><span class="co">#&gt;  9:  0.2764199 9.891560e-01</span></span>
<span><span class="co">#&gt; 10:  0.2178356 9.891560e-01</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="issues">Issues<a class="anchor" aria-label="anchor" href="#issues"></a>
</h2>
<p>If you encounter any bugs or have any specific feature requests, please <a href="https://github.com/insightsengineering/unihtee/issues" class="external-link">file an issue</a>.</p>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<p>Contributions are very welcome. Interested contributors should consult our <a href="https://github.com/insightsengineering/unihtee/blob/master/.github/CONTRIBUTING.md" class="external-link">contribution guidelines</a> prior to submitting a pull request.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Cite <code>unihtee</code> using the following BibTeX entry:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>manual{unihtee,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">=</span> {unihtee<span class="sc">:</span> Univariate Heterogeneous Treatment Effect Estimation},</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  author <span class="ot">=</span> {Philippe Boileau},</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  note <span class="ot">=</span> {R package version <span class="dv">0</span>.<span class="fl">0.1</span>}</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>The contents of this repository are distributed under the Apache 2.0 license. See the <a href="https://github.com/insightsengineering/unihtee/blob/main/LICENSE.md" class="external-link"><code>LICENSE.md</code></a> and <a href="https://github.com/insightsengineering/unihtee/blob/main/LICENSE" class="external-link"><code>LICENSE</code></a> files for details.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-boileau2022" class="csl-entry">
Boileau, Philippe, Nina Ting Qi, Mark J van der Laan, Sandrine Dudoit, and Ning Leng. 2022. “<span class="nocase">A flexible approach for predictive biomarker discovery</span>.” <em>Biostatistics</em>, July. <a href="https://doi.org/10.1093/biostatistics/kxac029" class="external-link uri">https://doi.org/10.1093/biostatistics/kxac029</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing unihtee</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Philippe Boileau <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4850-2507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Philippe Boileau.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
